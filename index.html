<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Devolveme - Recuperamos lo importante</title>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Palette */
            --bg-color: #f0f4f8;
            --primary-blue: #004e92;
            --text-main: #1a202c;
            --text-secondary: #4a5568;
            --white: #ffffff;

            /* Brand Colors */
            --whatsapp: #25D366;
            --telegram: #0088cc;
            --email: #EA4335;

            /* Shapes & Shadows */
            --radius-xl: 20px;
            --radius-md: 12px;
            --shadow-soft: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            --shadow-card: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.025);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            width: 90%;
            max-width: 1000px;
            /* Wider for desktop cards */
            margin: 0 auto;
            padding: 2rem 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- 1. Header & Logo --- */
        .header {
            width: 100%;
            display: flex;
            justify-content: center;
            margin-bottom: 3rem;
        }

        .logo {
            max-width: 280px;
            height: auto;
        }

        /* --- 2. Hero Section --- */
        .hero {
            text-align: center;
            margin-bottom: 3rem;
            max-width: 600px;
        }

        .hero h1 {
            color: var(--primary-blue);
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }

        .hero p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 400;
        }

        /* --- 3. Contact Section (Critical) --- */
        .contact-section {
            width: 100%;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin-bottom: 4rem;
        }

        .contact-btn-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 1.2rem;
            border-radius: var(--radius-xl);
            text-decoration: none;
            color: var(--white);
            font-weight: 600;
            font-size: 1.25rem;
            transition: all 0.2s ease;
            box-shadow: var(--shadow-soft);
            position: relative;
            overflow: hidden;
            border: none;
            cursor: pointer;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-card);
            opacity: 0.95;
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn svg {
            margin-right: 12px;
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        .btn-whatsapp {
            background-color: var(--whatsapp);
        }

        .btn-telegram {
            background-color: var(--telegram);
        }

        .btn-email {
            background-color: var(--email);
        }

        .helper-text {
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-align: center;
            opacity: 0.8;
        }

        /* --- 4. Info Cards Section --- */
        .cards-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            width: 100%;
            margin-bottom: 4rem;
        }

        /* Desktop: 3 columns */
        @media (min-width: 768px) {
            .cards-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .card {
            background: var(--white);
            padding: 2rem;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-soft);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            transition: transform 0.2s;
            height: 100%;
            /* Equal height */
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-card);
        }

        .card-icon {
            background-color: #f0f7ff;
            color: var(--primary-blue);
            width: 64px;
            height: 64px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        .card-icon svg {
            width: 32px;
            height: 32px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        .card h3 {
            color: var(--primary-blue);
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .card p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
        }

        /* --- 5. Instagram Section --- */
        .instagram-section {
            width: 100%;
            max-width: 600px;
            text-align: center;
            margin-bottom: 3rem;
        }

        .instagram-section h2 {
            font-size: 1.5rem;
            color: var(--text-main);
            margin-bottom: 0.5rem;
        }

        .ig-handle {
            display: inline-block;
            color: var(--primary-blue);
            font-weight: 600;
            text-decoration: none;
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .ig-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 1.5rem;
        }

        .ig-placeholder {
            background-color: #e2e8f0;
            border-radius: var(--radius-md);
            aspect-ratio: 1 / 1;
            /* Square */
        }

        .btn-secondary {
            display: inline-block;
            padding: 0.8rem 2rem;
            border: 2px solid #cbd5e0;
            border-radius: var(--radius-xl);
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s;
        }

        .btn-secondary:hover {
            border-color: var(--text-secondary);
            color: var(--text-main);
        }

        /* States */
        .hidden {
            display: none !important;
        }

        .loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background: var(--bg-color);
            z-index: 1000;
            color: var(--primary-blue);
            font-weight: 600;
        }
    </style>
</head>

<body>

    <!-- Loading -->
    <div id="loading" class="loading">Cargando Devolveme...</div>

    <div id="content" class="container hidden">

        <!-- 1. Header -->
        <header class="header">
            <!-- Usamos el logo.png que ya tenemos. Si falla, el alt hará de placeholder -->
            <img src="logo.png" alt="Devolveme Logo" class="logo">
        </header>

        <!-- 2. Hero -->
        <section class="hero">
            <h1 id="main-title">Bienvenido a Devolveme</h1>
            <p id="secondary-text">Estás a un paso de devolver un objeto perdido</p>
        </section>

        <!-- 3. Contact Buttons (Critical) -->
        <section class="contact-section">

            <!-- WhatsApp -->
            <div class="contact-btn-wrapper">
                <a id="btn-whatsapp" href="#" class="btn btn-whatsapp" target="_blank">
                    <!-- WhatsApp Icon SVG -->
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M17.472 14.382C17.112 14.202 15.344 13.332 15.016 13.212C14.688 13.092 14.448 13.032 14.208 13.392C13.968 13.752 13.28 14.562 13.072 14.802C12.864 15.042 12.656 15.072 12.296 14.892C11.936 14.712 10.776 14.332 9.4 13.106C8.32 12.142 7.592 10.952 7.384 10.592C7.176 10.232 7.36 10.04 7.544 9.86C7.704 9.704 7.904 9.452 8.088 9.242C8.272 9.032 8.336 8.882 8.456 8.642C8.576 8.402 8.512 8.192 8.416 8.002C8.32 7.812 7.632 6.132 7.344 5.452C7.064 4.792 6.784 4.882 6.576 4.882C6.384 4.882 6.16 4.882 5.936 4.882C5.712 4.882 5.352 4.966 5.048 5.296C4.744 5.626 3.88 6.436 3.88 8.086C3.88 9.736 5.08 11.332 5.248 11.558C5.416 11.784 7.624 15.188 10.992 16.642C13.792 17.848 14.352 17.608 14.96 17.548C15.568 17.488 16.928 16.762 17.208 15.968C17.488 15.174 17.488 14.498 17.408 14.366C17.328 14.234 17.112 14.148 16.752 13.968H17.472V14.382ZM11.976 21.998C10.224 21.998 8.584 21.548 7.128 20.75L3 22.088L4.36 18.026C3.512 16.55 3.064 14.858 3.064 13.118C3.064 8.216 7.064 4.226 11.976 4.226C16.888 4.226 20.888 8.216 20.888 13.118C20.88 18.014 16.896 21.998 11.976 21.998Z"
                            fill="white" />
                    </svg>
                    WhatsApp
                </a>
                <span class="helper-text">Comunicate con nosotros y ayudá a devolver este objeto</span>
            </div>

            <!-- Telegram -->
            <div class="contact-btn-wrapper">
                <a id="btn-telegram" href="#" class="btn btn-telegram" target="_blank">
                    <!-- Telegram Icon SVG -->
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M20.665 3.717L2.35 10.875C1.1 11.375 1.1 12.072 2.112 12.382L6.812 13.852L17.688 6.887C18.2 6.547 18.675 6.74 18.288 7.085L9.5 15.127V15.125L9.488 15.137L9.162 19.95C9.638 19.95 9.85 19.732 10.112 19.475L12.425 17.225L17.237 20.812C18.125 21.312 18.762 21.05 18.988 19.975L22.15 4.975C22.475 3.65 21.663 3.062 20.663 3.715L20.665 3.717Z"
                            fill="white" />
                    </svg>
                    Telegram
                </a>
                <span class="helper-text">Comunicate con nosotros y ayudá a devolver este objeto</span>
            </div>

            <!-- Email -->
            <div class="contact-btn-wrapper">
                <a id="btn-email" href="#" class="btn btn-email">
                    <!-- Envelope Icon SVG -->
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z"
                            fill="none" stroke="white" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                        <path d="M22 6L12 13L2 6" fill="none" stroke="white" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                    Email
                </a>
                <span class="helper-text">Comunicate con nosotros y ayudá a devolver este objeto</span>
            </div>
        </section>

        <!-- 4. Info Cards -->
        <section class="cards-grid">
            <!-- Card 1: Productos -->
            <a href="productos.html" class="card" style="text-decoration: none; color: inherit;">
                <div class="card-icon">
                    <!-- Tag Icon -->
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                        <line x1="7" y1="7" x2="7.01" y2="7"></line>
                    </svg>
                </div>
                <h3>Productos</h3>
                <p>Conocé el Llavero DEV.1. Rastreador Bluetooth certificado por Apple Find My y sistema de recuperación
                    QR.</p>
            </a>

            <!-- Card 2: Tecnología -->
            <a href="tecnologia.html" class="card" style="text-decoration: none; color: inherit;">
                <div class="card-icon">
                    <!-- Smartphone/Tech Icon -->
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect>
                        <line x1="12" y1="18" x2="12.01" y2="18"></line>
                    </svg>
                </div>
                <h3>Tecnología</h3>
                <p>Sistema QR y NFC sin apps intermediarias. Notificaciones instantáneas y protección de identidad.</p>
            </a>

            <!-- Card 3: Compromisos Sociales -->
            <a href="compromisos.html" class="card" style="text-decoration: none; color: inherit;">
                <div class="card-icon">
                    <!-- Heart/Hands Icon -->
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z">
                        </path>
                    </svg>
                </div>
                <h3>Compromisos Sociales</h3>
                <p>Tecnología con propósito. Apoyamos el desarrollo de soluciones para adultos mayores y comunidades con
                    necesidades especiales.</p>
            </a>
        </section>

        <!-- 5. Instagram Section -->
        <section class="instagram-section">
            <h2>Seguinos en Instagram</h2>
            <a href="https://www.instagram.com/devolveme_la" target="_blank" class="ig-handle">@devolveme_la</a>

            <a href="https://www.instagram.com/devolveme_la?igsh=MTcxNG82bWVjN2l3" target="_blank"
                class="btn-secondary">
                Ver en Instagram
            </a>
        </section>

    </div>

    <!-- --- CHAT WIDGET START --- -->
    <style>
        /* Chat Widget Styles */
        .chat-widget-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary-blue);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s;
            z-index: 1000;
        }

        .chat-widget-btn:hover {
            transform: scale(1.1);
        }

        .chat-window {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 380px;
            height: 600px;
            max-width: 90vw;
            max-height: 80vh;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            z-index: 1000;
            overflow: hidden;
            display: none;
            /* Hidden by default */
        }

        .chat-window.open {
            display: flex;
        }

        .chat-header {
            background-color: var(--primary-blue);
            color: white;
            padding: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-close {
            cursor: pointer;
            font-size: 1.2rem;
        }

        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background-color: #f7f9fc;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 12px;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .msg-agent {
            background-color: white;
            color: var(--text-main);
            align-self: flex-start;
            border-bottom-left-radius: 2px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .msg-user {
            background-color: var(--primary-blue);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 2px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .chat-input-area {
            padding: 15px;
            background-color: white;
            border-top: 1px solid #eef2f6;
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            padding: 10px 15px;
            font-family: inherit;
            outline: none;
        }

        .chat-send {
            background-color: var(--primary-blue);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>

    <!-- Floating Button -->
    <div class="chat-widget-btn" id="chat-toggle">
        <!-- Chat Icon -->
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round" width="28" height="28">
            <path
                d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z">
            </path>
        </svg>
    </div>

    <!-- Chat Window -->
    <div class="chat-window" id="chat-window">
        <div class="chat-header">
            <span>Soporte Devolveme AI</span>
            <span class="chat-close" id="chat-close">✕</span>
        </div>
        <div class="chat-messages" id="chat-messages">
            <!-- Messages go here -->
            <div class="message msg-agent">Hola, soy el asistente virtual de Devolveme. Te recomiendo contactarnos
                directamente por WhatsApp o Telegram para una respuesta más rápida. ¿En qué puedo ayudarte?</div>
        </div>
        <div class="chat-input-area">
            <input type="text" class="chat-input" id="chat-input" placeholder="Escribe un mensaje...">
            <button class="chat-send" id="chat-send-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" width="20" height="20">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
            </button>
        </div>
    </div>
    <!-- --- CHAT WIDGET END --- -->

    <!-- Logic Script (Preserved & Adapted) -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const loading = document.getElementById('loading');
            const content = document.getElementById('content');

            const mainTitle = document.getElementById('main-title');
            const secondaryText = document.getElementById('secondary-text');

            const whatsappBtn = document.getElementById('btn-whatsapp');
            const telegramBtn = document.getElementById('btn-telegram');
            const emailBtn = document.getElementById('btn-email');

            // URL Parser (Supports Upper/Lowercase)
            const path = window.location.pathname;
            const match = path.match(/\/f\/([a-zA-Z0-9]+)/i);
            const code = match ? match[1] : null;

            if (code) {
                console.log("Modo Detector de Objeto Activado. Código:", code);

                // --- WhatsApp ---
                const waText = encodeURIComponent(`Hola, código ${code}`);
                whatsappBtn.href = `https://wa.me/5491132466022?text=${waText}`;

                // --- Telegram ---
                telegramBtn.href = `https://t.me/DEVOLVEME_BOT?start=${code}`;

                // --- Email ---
                const emailSubject = encodeURIComponent(`Código ${code}`);
                const emailBody = encodeURIComponent(`Hola, escaneé el código ${code}`);
                emailBtn.href = `mailto:devolveme.arg@gmail.com?subject=${emailSubject}&body=${emailBody}`;

            } else {
                console.log("Modo Visitante General");

                // Fallback Content if needed (Current content is already generic enough)
                // We keep generic links
                const waText = encodeURIComponent("Hola, quisiera más información sobre Devolveme.");
                whatsappBtn.href = `https://wa.me/5491132466022?text=${waText}`;

                telegramBtn.href = `https://t.me/DEVOLVEME_BOT`;

                const emailSubject = encodeURIComponent("Consulta General");
                const emailBody = encodeURIComponent("Hola, quisiera más información...");
                emailBtn.href = `mailto:devolveme.arg@gmail.com?subject=${emailSubject}&body=${emailBody}`;
            }

            // Reveal UI
            loading.style.display = 'none';
            content.classList.remove('hidden');

            // --- CHAT WIDGET LOGIC ---
            const chatToggle = document.getElementById('chat-toggle');
            const chatClose = document.getElementById('chat-close');
            const chatWindow = document.getElementById('chat-window');
            const chatInput = document.getElementById('chat-input');
            const chatSendBtn = document.getElementById('chat-send-btn');
            const chatMessages = document.getElementById('chat-messages');

            // NGROK URL (HARDCODED FOR DEMO)
            const API_URL = "https://patchiest-izaiah-commemorable.ngrok-free.dev/api/v1/web/chat";
            const USER_ID = "guest_" + Math.floor(Math.random() * 10000);

            let hasGreetedWithCode = false;

            function toggleChat() {
                chatWindow.classList.toggle('open');
                if (chatWindow.classList.contains('open') && code && !hasGreetedWithCode) {
                    // Auto-send code greeting if first open
                    hasGreetedWithCode = true;
                    // Simulate user typing
                    const msg = `Hola, encontré el objeto con código ${code}`;
                    addMessage(msg, 'user');
                    sendMessageToBackend(msg);
                }
            }

            chatToggle.addEventListener('click', toggleChat);
            chatClose.addEventListener('click', toggleChat);

            function addMessage(text, sender) {
                const div = document.createElement('div');
                div.classList.add('message', sender === 'user' ? 'msg-user' : 'msg-agent');
                div.textContent = text;
                chatMessages.appendChild(div);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            async function sendMessageToBackend(text) {
                try {
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: text,
                            user_id: USER_ID
                        })
                    });

                    if (!response.ok) throw new Error('Network error');

                    const data = await response.json();
                    addMessage(data.response, 'agent');

                } catch (error) {
                    console.error("Chat Error:", error);
                    addMessage("Lo siento, perdí la conexión con el servidor.", 'agent');
                }
            }

            function handleSend() {
                const text = chatInput.value.trim();
                if (!text) return;

                addMessage(text, 'user');
                chatInput.value = '';
                sendMessageToBackend(text);
            }

            chatSendBtn.addEventListener('click', handleSend);
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleSend();
            });
            // -------------------------
        });
    </script>
</body>

</html>